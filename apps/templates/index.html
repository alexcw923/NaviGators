{% load static %}
<html>
  <head>
    <link rel="stylesheet" href="{% static 'style/style.css' %}">
    <link rel="stylesheet" href="{% static 'style/searchbar.css' %}">
    <link rel="stylesheet" href="{% static 'style/sidebar.css' %}">
    <link rel="stylesheet" href="https://js.arcgis.com/4.27/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.27/"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
    <title>NaviGator</title>
  </head>
  <body style="width: 100%; height: 100%; margin: 0; padding: 0;">
    <!-- top of the web page -->
    <div class="header">
      <button class="openbtn" onclick="toggleSidebar()">&#9776;</button>

      <div class="wrapper">
        <!-- search bar -->
        <div class="searchBar">
          <input id="searchQueryInput" type="text" name="searchQueryInput" placeholder="Search" value="" />
          <!-- submit button for search query -->
          <button id="searchQuerySubmit" type="submit" name="searchQuerySubmit">
            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
              <path fill="#666666" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 
              15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,
              20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,
              16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,
              3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,
              12 14,9.5C14,7 12,5 9.5,5Z" />
            </svg>
          </button>
        </div>
        
      </div>
    </div>
    <div class="body">
      <!-- user utilities on the left hand side (could make it hidden) -->
      <div id="leftSideBar" class="sidebar">
        <a href="#">Profile</a>
        <a href="#">Favorite</a>
        <a href="#">Feed</a>
        <a href="#">Settings</a>
        
      </div>
      <div id="content">

        <div class="userPreferences" style="background-color: #f0f0f0;">
          <form id="myForm">
            <div>
              <label for="origin">Origin:</label>
              <input type="text" id="origin" name="origin" required>
            </div>

            <div>
              <label for="destination">Destination:</label>
              <input type="text" id="destination" name="destination" required>
            </div>

            <div>
              <input type="submit" value="Submit">
            </div>
          
            <div>
              <label for="latitude">Latitude:</label>
              <input type="text" id="latitude">
            </div>

            <div>
              <label for="longitude">Longitude:</label>
              <input type="text" id="longitude">
            </div>

            <div>
              <label for="category">Category:</label>
              <input type="text" id="category">
            </div>

            <div>
              <label for="search_radius">Search Radius:</label>
              <input type="number" id="search_radius" value="25">
            </div>

            <div>
              <label for="max_locations">Max Locations:</label>
              <input type="number" id="max_locations" value="25">
            </div>

            <div>
              <button onclick="getNearbyPlaces()">Get Nearby Places</button>
              <div id="jsonOutput"></div>
            </div>
          </form>
        </div>

        <div class="mapContainer" style="background-color: #fafafa;">
          <div id="map"></div>
        </div>
      </div>
    </div>
    
    <script>
      function getNearbyPlaces() {
        console.log("getNearbyPlaces called");
        const latitude = document.getElementById('latitude').value;
        const longitude = document.getElementById('longitude').value;
        const category = document.getElementById('category').value;
        const search_radius = document.getElementById('search_radius').value;
        const max_locations = document.getElementById('max_locations').value;
        fetch(`http://127.0.0.1:8000/search/?latitude=${latitude}&longitude=${longitude}&category=${category}&search_radius=${search_radius}&max_locations=${max_locations}`)
          .then(response => response.json())
          .then(data => {
              // Handle the JSON data here
              // For demonstration, display the JSON string in the div with id 'jsonOutput'
              document.getElementById('jsonOutput').innerText = JSON.stringify(data);
              showNearbyPoint(data);
              
          })
          .catch(error => console.error('Error fetching data:', error));
      }
      function toggleSidebar() {
        var sidebar = document.getElementById("leftSideBar");
        var content = document.getElementById("content");
        const size = "120px"
        if (sidebar.style.width === size) {
            sidebar.style.width = "0px";
            content.style.marginLeft = "0px";
    
        } else {
            sidebar.style.width = size;
            content.style.marginLeft = size;
        }
    }
    </script>
    <script src="{% static 'script.js' %}"></script>
  </body>
</html>